// <auto-generated/>
#pragma warning disable
#nullable enable annotations


using System;
using System.Threading.Tasks;

namespace MyCode;

/// <summary>
/// <para>
/// Number of services registered: 4<br />
/// - Singleton: 1<br />
/// - Scoped: 1<br />
/// - Transient: 2<br />
/// - Delegate: 0
/// </para>
/// <para>
/// This provider can create a scope,<br />
/// implements only asynchronous DisposeAsync() method<br />
/// and is thread safe.
/// </para>
/// </summary>
public sealed partial class TestProvider : ITestProvider, IServiceProvider {
    /// <summary>
    /// Creates an instance of <see cref="global::MyCode.TestProvider"/> together with all <see cref="global::CircleDIAttributes.CreationTiming.Constructor">non-lazy</see> singleton services.
    /// </summary>
    public TestProvider() {
    }

    /// <summary>
    /// Creates an instance of <see cref="global::MyCode.TestProvider.Scope"/> together with all <see cref="global::CircleDIAttributes.CreationTiming.Constructor">non-lazy</see> scoped services.
    /// </summary>
    public global::MyCode.ITestProvider.IScope CreateScope() => new global::MyCode.TestProvider.Scope(Self);


    /// <summary>
    /// Lifetime: <see cref="global::CircleDIAttributes.SingletonAttribute{TService}">Singleton</see><br />
    /// Service type: <see cref="global::MyCode.ITestProvider"/><br />
    /// Implementation type:  <see cref="global::MyCode.TestProvider"/>
    /// </summary>
    public global::MyCode.ITestProvider Self => this;


    /// <summary>
    /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
    /// Service type: <see cref="global::MyCode.IServiceDispose"/><br />
    /// Implementation type:  <see cref="global::MyCode.ServiceDispose"/>
    /// </summary>
    public global::MyCode.IServiceDispose ServiceDispose {
        get {
            global::MyCode.ServiceDispose serviceDispose = new global::MyCode.ServiceDispose();
            lock (disposeList)
                disposeList.Add(serviceDispose);
            return serviceDispose;
        }
    }

    /// <summary>
    /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
    /// Service type: <see cref="global::MyCode.IServiceDisposeAsync"/><br />
    /// Implementation type:  <see cref="global::MyCode.ServiceDisposeAsync"/>
    /// </summary>
    public global::MyCode.IServiceDisposeAsync ServiceDisposeAsync {
        get {
            global::MyCode.ServiceDisposeAsync serviceDisposeAsync = new global::MyCode.ServiceDisposeAsync();
            lock (asyncDisposeList)
                asyncDisposeList.Add(serviceDisposeAsync);
            return serviceDisposeAsync;
        }
    }


    /// <summary>
    /// <para>Finds all registered services of the given type.</para>
    /// <para>
    /// The method returns<br />
    /// - null (when registered zero times)<br />
    /// - given type (when registered ones)<br />
    /// - Array of given type (when registered many times)
    /// </para>
    /// </summary>
    object? IServiceProvider.GetService(Type serviceType) {
        return serviceType.FullName switch {
            "MyCode.IServiceDispose" => ServiceDispose,
            "MyCode.IServiceDisposeAsync" => ServiceDisposeAsync,
            "MyCode.ITestProvider" => Self,
            "MyCode.ITestProvider.IScope" => CreateScope(),
            _ => null
        };
    }


    private global::System.Collections.Generic.List<IDisposable> disposeList = [];

    private global::System.Collections.Generic.List<IAsyncDisposable> asyncDisposeList = [];

    /// <summary>
    /// Disposes all disposable services instantiated by this provider asynchronously.
    /// </summary>
    public ValueTask DisposeAsync() {
        lock (disposeList)
            foreach (IDisposable disposable in disposeList)
                disposable.Dispose();

        Task[] disposeTasks = new Task[asyncDisposeList.Count];

        int index = 0;
        lock (asyncDisposeList)
            foreach (IAsyncDisposable asyncDisposable in asyncDisposeList)
                disposeTasks[index++] = asyncDisposable.DisposeAsync().AsTask();

        return new ValueTask(Task.WhenAll(disposeTasks));
    }



    /// <summary>
    /// <para>
    /// Number of services registered: 4<br />
    /// - Singleton: 1<br />
    /// - Scoped: 1<br />
    /// - Transient: 2<br />
    /// - Delegate: 0
    /// </para>
    /// <para>
    /// This provider can create a scope,<br />
    /// implements only asynchronous DisposeAsync() method<br />
    /// and is thread safe.
    /// </para>
    /// </summary>
    public sealed partial class Scope : ITestProvider.IScope, IServiceProvider {
        private ITestProvider __serviceProvider;

        /// <summary>
        /// Creates an instance of <see cref="global::MyCode.TestProvider.Scope"/> together with all <see cref="global::CircleDIAttributes.CreationTiming.Constructor">non-lazy</see> scoped services.
        /// </summary>
        /// <param name="serviceProvider">An instance of the service provider this provider is the scope of.</param>
        public Scope(ITestProvider serviceProvider) {
            __serviceProvider = serviceProvider;
        }

        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.ScopedAttribute{TService}">Scoped</see><br />
        /// Service type: <see cref="global::MyCode.ITestProvider.IScope"/><br />
        /// Implementation type:  <see cref="global::MyCode.TestProvider.Scope"/>
        /// </summary>
        public global::MyCode.ITestProvider.IScope SelfScope => this;


        /// <summary>
        /// Creates an instance of <see cref="global::MyCode.TestProvider.Scope"/> together with all <see cref="global::CircleDIAttributes.CreationTiming.Constructor">non-lazy</see> scoped services.
        /// </summary>
        public global::MyCode.ITestProvider.IScope CreateScope() => __serviceProvider.CreateScope();

        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.SingletonAttribute{TService}">Singleton</see><br />
        /// Service type: <see cref="global::MyCode.ITestProvider"/><br />
        /// Implementation type:  <see cref="global::MyCode.TestProvider"/>
        /// </summary>
        public global::MyCode.ITestProvider Self => __serviceProvider.Self;


        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
        /// Service type: <see cref="global::MyCode.IServiceDispose"/><br />
        /// Implementation type:  <see cref="global::MyCode.ServiceDispose"/>
        /// </summary>
        public global::MyCode.IServiceDispose ServiceDispose {
            get {
                global::MyCode.ServiceDispose serviceDispose = new global::MyCode.ServiceDispose();
                lock (disposeList)
                    disposeList.Add(serviceDispose);
                return serviceDispose;
            }
        }

        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
        /// Service type: <see cref="global::MyCode.IServiceDisposeAsync"/><br />
        /// Implementation type:  <see cref="global::MyCode.ServiceDisposeAsync"/>
        /// </summary>
        public global::MyCode.IServiceDisposeAsync ServiceDisposeAsync {
            get {
                global::MyCode.ServiceDisposeAsync serviceDisposeAsync = new global::MyCode.ServiceDisposeAsync();
                lock (asyncDisposeList)
                    asyncDisposeList.Add(serviceDisposeAsync);
                return serviceDisposeAsync;
            }
        }


        /// <summary>
        /// <para>Finds all registered services of the given type.</para>
        /// <para>
        /// The method returns<br />
        /// - null (when registered zero times)<br />
        /// - given type (when registered ones)<br />
        /// - Array of given type (when registered many times)
        /// </para>
        /// </summary>
        object? IServiceProvider.GetService(Type serviceType) {
            return serviceType.FullName switch {
                "MyCode.IServiceDispose" => ServiceDispose,
                "MyCode.IServiceDisposeAsync" => ServiceDisposeAsync,
                "MyCode.ITestProvider" => Self,
                "MyCode.ITestProvider.IScope" => (global::MyCode.ITestProvider.IScope[])[SelfScope, CreateScope()],
                _ => null
            };
        }


        private global::System.Collections.Generic.List<IDisposable> disposeList = [];

        private global::System.Collections.Generic.List<IAsyncDisposable> asyncDisposeList = [];

        /// <summary>
        /// Disposes all disposable services instantiated by this provider asynchronously.
        /// </summary>
        public ValueTask DisposeAsync() {
            lock (disposeList)
                foreach (IDisposable disposable in disposeList)
                    disposable.Dispose();

            Task[] disposeTasks = new Task[asyncDisposeList.Count];

            int index = 0;
            lock (asyncDisposeList)
                foreach (IAsyncDisposable asyncDisposable in asyncDisposeList)
                    disposeTasks[index++] = asyncDisposable.DisposeAsync().AsTask();

            return new ValueTask(Task.WhenAll(disposeTasks));
        }
    }
}


---------
Interface
---------

// <auto-generated/>
#pragma warning disable
#nullable enable annotations


using System;

namespace MyCode;

/// <summary>
/// <para>
/// Number of services registered: 4<br />
/// - Singleton: 1<br />
/// - Scoped: 1<br />
/// - Transient: 2<br />
/// - Delegate: 0
/// </para>
/// <para>
/// This provider can create a scope,<br />
/// implements only asynchronous DisposeAsync() method<br />
/// and is thread safe.
/// </para>
/// </summary>
public partial interface ITestProvider : IAsyncDisposable {
    /// <summary>
    /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
    /// Service type: <see cref="global::MyCode.IServiceDispose"/><br />
    /// Implementation type:  <see cref="global::MyCode.ServiceDispose"/>
    /// </summary>
    global::MyCode.IServiceDispose ServiceDispose { get; }

    /// <summary>
    /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
    /// Service type: <see cref="global::MyCode.IServiceDisposeAsync"/><br />
    /// Implementation type:  <see cref="global::MyCode.ServiceDisposeAsync"/>
    /// </summary>
    global::MyCode.IServiceDisposeAsync ServiceDisposeAsync { get; }

    /// <summary>
    /// Lifetime: <see cref="global::CircleDIAttributes.SingletonAttribute{TService}">Singleton</see><br />
    /// Service type: <see cref="global::MyCode.ITestProvider"/><br />
    /// Implementation type:  <see cref="global::MyCode.TestProvider"/>
    /// </summary>
    global::MyCode.ITestProvider Self { get; }

    /// <summary>
    /// Creates an instance of <see cref="global::MyCode.TestProvider.Scope"/> together with all <see cref="global::CircleDIAttributes.CreationTiming.Constructor">non-lazy</see> scoped services.
    /// </summary>
    global::MyCode.ITestProvider.IScope CreateScope();

    /// <summary>
    /// <para>
    /// Number of services registered: 4<br />
    /// - Singleton: 1<br />
    /// - Scoped: 1<br />
    /// - Transient: 2<br />
    /// - Delegate: 0
    /// </para>
    /// <para>
    /// This provider can create a scope,<br />
    /// implements only asynchronous DisposeAsync() method<br />
    /// and is thread safe.
    /// </para>
    /// </summary>
    public partial interface IScope : IAsyncDisposable {
        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
        /// Service type: <see cref="global::MyCode.IServiceDispose"/><br />
        /// Implementation type:  <see cref="global::MyCode.ServiceDispose"/>
        /// </summary>
        global::MyCode.IServiceDispose ServiceDispose { get; }

        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.TransientAttribute{TService}">Transient</see><br />
        /// Service type: <see cref="global::MyCode.IServiceDisposeAsync"/><br />
        /// Implementation type:  <see cref="global::MyCode.ServiceDisposeAsync"/>
        /// </summary>
        global::MyCode.IServiceDisposeAsync ServiceDisposeAsync { get; }

        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.SingletonAttribute{TService}">Singleton</see><br />
        /// Service type: <see cref="global::MyCode.ITestProvider"/><br />
        /// Implementation type:  <see cref="global::MyCode.TestProvider"/>
        /// </summary>
        global::MyCode.ITestProvider Self { get; }

        /// <summary>
        /// Lifetime: <see cref="global::CircleDIAttributes.ScopedAttribute{TService}">Scoped</see><br />
        /// Service type: <see cref="global::MyCode.ITestProvider.IScope"/><br />
        /// Implementation type:  <see cref="global::MyCode.TestProvider.Scope"/>
        /// </summary>
        global::MyCode.ITestProvider.IScope SelfScope { get; }

        /// <summary>
        /// Creates an instance of <see cref="global::MyCode.TestProvider.Scope"/> together with all <see cref="global::CircleDIAttributes.CreationTiming.Constructor">non-lazy</see> scoped services.
        /// </summary>
        global::MyCode.ITestProvider.IScope CreateScope();    }
}
